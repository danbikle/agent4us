<code class='bash'>
def forward(self, observation):
    # Select an action.
    state = self.memory.get_recent_state(observation)
    q_values = self.compute_q_values(state)
    if self.training:
        action = self.policy.select_action(q_values=q_values)
    else:
        action = self.test_policy.select_action(q_values=q_values)

    # Book-keeping.
    self.recent_observation = observation
    self.recent_action = action

    return action
</code>
